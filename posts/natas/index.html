<!DOCTYPE html>
<html><head>
<title>OverTheWire: Natas</title>




<meta charset="utf-8">
<meta name="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<meta content="telephone=no" name="format-detection">
<meta name="description" content="">
<meta name="renderer" content="webkit">
<meta name="theme-color" content="#ffffff">











<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'G-GGX6B7CJG5', 'auto');
	
	ga('send', 'pageview');
}
</script>







  




<link rel="icon" href="https://github.com/koolaidxk1d.png">



      <script src="/js/toc.js"></script>
    
    <link type="text/css" rel="stylesheet" href="/vendor/css/bootstrap.min.css">

<link rel="stylesheet" href="/scss/dark-mode.min.a6b0bcb25b2aaef899d0a3c8ae731ea776edd7912254d9a502cf30f2983c19d3.css" integrity="sha256-prC8slsqrviZ0KPIrnMep3bt15EiVNmlAs8w8pg8GdM=" media="screen">


<link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Material+Icons">



















</head>
<body>
    	<div id="app"><div class="single-column-drawer-container" id="drawer"
     v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }">
    <div class="drawer-content">
        <div class="drawer-menu">
            
            
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/posts/links">
                    Cool Links
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/posts/infographics">
                    Infographics
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/posts/about">
                    About Me
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/html/index.html">
                    ???
                </a>
                
            
            
            <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- CATALOG -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#level-0" class="nav-level-0">
									Level 0
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-1" class="nav-level-1">
									Level 1
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-2" class="nav-level-2">
									Level 2
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-3" class="nav-level-3">
									Level 3
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-4" class="nav-level-4">
									Level 4
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-5" class="nav-level-5">
									Level 5
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-6" class="nav-level-6">
									Level 6
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-7" class="nav-level-7">
									Level 7
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-8" class="nav-level-8">
									Level 8
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-9" class="nav-level-9">
									Level 9
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
            
        </div>
    </div>
</div>
<transition name="fade">
    <div id="drawer-mask" v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if="isDrawerOpen" v-on:click="toggleDrawer"></div>
</transition>
<nav id="navBar" class="navbar sticky-top navbar-light single-column-nav-container">
    <div id="navBackground" class="nav-background"></div>
    <div class="container container-narrow nav-content">
        <button id="nav_dropdown_btn" class="nav-dropdown-toggle" type="button" v-on:click="toggleDrawer">
            <i class="material-icons">
                menu
            </i>
        </button>
        <a id="navTitle" class="navbar-brand" href="https://koolaidxk1d.github.io/">
            koolaidxk1d
        </a>
        
        <button type="button" class="nav-darkmode-toggle" id="darkModeToggleButton2">
            <i class="material-icons" id="darkModeToggleIcon2">
                dark_mode
            </i>
        </button>
        
    </div>
</nav>
<div class="single-column-header-container" id="pageHead"
     v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }">
    <a href="https://koolaidxk1d.github.io/">
        <div class="single-column-header-title">koolaidxk1d</div>
        

    </a>
</div>

            <div id="content">
                <div id="streamContainer" class="stream-container">

    <div class="post-list-container post-list-container-shadow">
        <div class="post">
            
            
            
                
            

            <div class="post-head-wrapper"
                
                    
                    
                    style="background-image: url('https://koolaidxk1d.github.io/images/natas.jpg')"
                    
                
            >
                <div class="post-title">
                    OverTheWire: Natas
                    
                    <div class="post-meta">
                        
                        <time itemprop="datePublished">
                            2023-06-21 18:16
                        </time>
                        

                        

                        
                        
                    </div>
                </div>
            </div>
            
            <div class="post-body-wrapper">
                
                <div class="post-body" v-pre>
                
                    <p>Back for more password hunting! This time we are doing a more web-oriented wargame. Similarly to leviathan, no hints are given on the webpage. This game provides no SSH access; everything is done in the browser.</p>
<p>I&rsquo;m lacking in web-dev knowledge to say the least, so this will be quite challenging.</p>
<hr>
<h2 id="level-0">Level 0</h2>
<p>The password is right in your face the moment you look at the html.</p>
<p><img src="/images/natas0-0.png" alt=""></p>
<hr>
<h2 id="level-1">Level 1</h2>
<p>Same story as level 0, however the workaround is just using the hotkey to open the inspector.
<img src="/images/natas1-0.png" alt=""></p>
<hr>
<h2 id="level-2">Level 2</h2>
<p><img src="/images/natas2-0.png" alt=""></p>
<p>On this level, i can see a png file in the html. I decided to download it. I figured the password might be in the exif data, or perhaps in the raw bytes of the file itself.</p>
<p>No dice&hellip;</p>
<p>Then I thought that maybe I just needed to hash the contents of the file&hellip;.however the previous passwords were 32 char alphanumeric. To my knowledge that doesn&rsquo;t follow the format of any hashing algorithms.</p>
<p>I wracked my brain for way too long before I realized that the file was in the <strong>files/ subdirectory</strong>. I felt like a total idiot when I realized.</p>
<p><img src="/images/natas2-1.png" alt=""></p>
<p>Inside users.txt was the password I sought.</p>
<hr>
<h2 id="level-3">Level 3</h2>
<p>I was stumped on this one for a while, until I thought harder about the comment in the html.</p>
<p><img src="/images/natas3-0.png" alt=""></p>
<p>&ldquo;Not even Google will find it&rdquo;.</p>
<p>When Google indexes your website, you can prevent it from crawling certain directories by specifying them in a file called &ldquo;robots.txt&rdquo;. Because of the very concept of this file, it must be publicly available. We can therefore access it by typing it into the url bar.</p>
<p><img src="/images/natas3-1.png" alt=""></p>
<p>Let&rsquo;s navigate there.</p>
<p><img src="/images/natas3-2.png" alt="">
Once again, the pass is inside the txt.</p>
<hr>
<h2 id="level-4">Level 4</h2>
<p>This level seems to be picky about the place from where I was linked to the website.</p>
<p><img src="/images/natas4-0.png" alt=""></p>
<p>There is an HTTP header included in GET requests that specifies the &ldquo;referrer&rdquo;. I believe we will have to spoof this to appear as though we are coming from natas5. I couldn&rsquo;t find a way to do this natively in the inspector, as the referrer header is greyed out and cannot be edited. I decided to use this firefox extension:</p>
<p><a href="https://addons.mozilla.org/en-US/firefox/addon/referercontrol/">https://addons.mozilla.org/en-US/firefox/addon/referercontrol/</a></p>
<p>Once I spoofed the referrer header I was given the password.</p>
<p><img src="/images/natas4-1.png" alt=""></p>
<hr>
<h2 id="level-5">Level 5</h2>
<p>&ldquo;Access disallowed. You are not logged in.&rdquo;</p>
<p>Well&hellip;we are logged in using the password from the last level, but it seems there is another layer of access control on this level.</p>
<p>My first instinct is to check the cookies.</p>
<p><img src="/images/natas5-0.png" alt=""></p>
<p>I set that to 1 and refreshed. Lo and behold, the password appeared.</p>
<hr>
<h2 id="level-6">Level 6</h2>
<p>A text box labeled &ldquo;Input secret: &quot; and a submit button. The source code is available for this level. Let&rsquo;s take a look.</p>
<p><img src="/images/natas6-0.png" alt=""></p>
<p>If we look at the beginning of the php section, we can see that a file at &ldquo;includes/secret.inc&rdquo; is included in the file, which is likely where the secret is stored.</p>
<p>If we type that after the url we can direct the browser to the file.</p>
<p><img src="/images/natas6-1.png" alt=""></p>
<p>Copy the secret into the form and it returns the password to the next level.</p>
<hr>
<h2 id="level-7">Level 7</h2>
<p>We have two links to different pages on the site. Opening the inspector gives us an interesting hint in the form of an html comment.</p>
<p><img src="/images/natas7-0.png" alt=""></p>
<p>It seems to want us to traverse to /etc/natas_webpass/ (where every user&rsquo;s password resides).</p>
<p>In the url we can see that a url parameter is used called page. It likely refers to the filename of the page we are visiting. It may be possible to use &ldquo;../&rdquo; to go up a directory and get us to the file we want.</p>
<p>We can briefly test this by entering it once as the value. Now we get a warning shown:</p>
<p><img src="/images/natas7-1.png" alt=""></p>
<p>This is actually a good thing, because we can see that it is indeed taking us to different places within the filesystem. Additionally, since this warning is so verbose, we can see where we are. Using this information, we can easily format the url as follows to get to the password:</p>
<p><code>http://natas7.natas.labs.overthewire.org/index.php?page=../../../../etc/natas_webpass/natas8</code></p>
<p><img src="/images/natas7-2.png" alt=""></p>
<hr>
<h2 id="level-8">Level 8</h2>
<p>Once again, a level is asking for a secret input. The source code is provided.</p>
<p>In the source code, we can see the contents of the secret:</p>
<p><img src="levels/natas8-0.png" alt=""></p>
<p>We can see the exact formula used to create the encoded secret. Following the nested operations, we should first convert the hex to its binary representation, then reverse it, and finally base64 decode it. We can do all of this very quickly and easily with <a href="https://gchq.github.io/CyberChef/">CyberChef</a>.</p>
<p><img src="/images/natas8-1.png" alt=""></p>
<p>Entering the output gets us the password to level 9.</p>
<hr>
<h2 id="level-9">Level 9</h2>
<p>A search box allows us to search for a word in an unknown set of data. The site displays the search results under &ldquo;Output:&rdquo;.</p>
<p><img src="/images/natas9-0.png" alt=""></p>

                    
                    <HR width="100%" id="EOF">
		    <p style="color:#777;">Last modified on 2023-06-21</p>
                    
                </div>
            </div>
            
            
            <nav class="post-pagination">

                
                <a class="newer-posts" href="/posts/infographics/">
			Next<br>Infographics
                </a>
                
                
                
                <a class="older-posts" href="/posts/links/">
			Previous<br>Cool Links
                </a>
                
            </nav>
            <div class="post-comment-wrapper">
                










<script src="https://utteranc.es/client.js"
        repo="koolaidxk1d/koolaidxk1d.github.io"
        issue-term="title"
        label="your label"
        theme="preferred-color-scheme"
        crossorigin="anonymous"
        async>
</script>



            </div>
        </div>
    </div>


                    </div>
            </div><div id="sideContainer" class="side-container">
    
    <a class="a-block nav-head false" href="https://koolaidxk1d.github.io/">
    
        <div class="nav-title">
            koolaidxk1d
        </div>
        
    </a>

    <div class="nav-link-list">
        
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/posts/links">
                Cool Links
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/posts/infographics">
                Infographics
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/posts/about">
                About Me
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/html/index.html">
                ???
            </a>
            
        
    </div>

    

    <div class="nav-footer">
        

&copy;
	
	2023 koolaidxk1d
	

    </div>
    
</div><div id="extraContainer" class="extra-container">
    <div class="toc-wrapper">
        

        
        <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- CATALOG -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#level-0" class="nav-level-0">
									Level 0
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-1" class="nav-level-1">
									Level 1
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-2" class="nav-level-2">
									Level 2
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-3" class="nav-level-3">
									Level 3
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-4" class="nav-level-4">
									Level 4
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-5" class="nav-level-5">
									Level 5
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-6" class="nav-level-6">
									Level 6
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-7" class="nav-level-7">
									Level 7
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-8" class="nav-level-8">
									Level 8
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#level-9" class="nav-level-9">
									Level 9
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
        
    </div>
    <div class="pagination">
        <a id="globalBackToTop" class="pagination-action animated-visibility" href="#top"
            :class="{ invisible: scrollY == 0 }">
            <i class="material-icons pagination-action-icon">
                keyboard_arrow_up
            </i>
        </a>
        
        <a type="button" class="pagination-action" id="darkModeToggleButton">
            <span class="material-icons pagination-action-icon" id="darkModeToggleIcon">
                dark_mode
            </span>
        </a>
        
        
    </div>
</div><div id="single-column-footer">

&copy;
	
	2023 koolaidxk1d
	
</div>
            </div>
    
    <script src="/js/journal.js"></script></body>
</html>
